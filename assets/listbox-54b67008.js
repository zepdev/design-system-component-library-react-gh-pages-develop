import{r as c,R as U}from"./index-b1e7e93e.js";import{y as be,i as ee,u as ve,c as y,f as xe}from"./calculate-active-index-3663c4e1.js";import{T as me,p as N,e as ge,o as K}from"./form-2a2adf59.js";import{o as p,O as Y,U as C,y as E,u as P,l as z,x as Oe,C as F,I as V,T as Re,a as Se,b as m}from"./keyboard-93128b4d.js";import{u as he,s as Le}from"./hidden-601067d7.js";import{s as ye,d as H,u as Ie}from"./open-closed-23b462a4.js";import{r as Te}from"./bugs-8e007c11.js";import{h as $e,T as De,I as Pe}from"./focus-management-5143e399.js";import{o as Ce}from"./owner-1e815d84.js";let Z=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function _(e){var o,i;let r=(o=e.innerText)!=null?o:"",a=e.cloneNode(!0);if(!(a instanceof HTMLElement))return r;let u=!1;for(let l of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),u=!0;let t=u?(i=a.innerText)!=null?i:"":r;return Z.test(t)&&(t=t.replace(Z,"")),t}function Ee(e){let o=e.getAttribute("aria-label");if(typeof o=="string")return o.trim();let i=e.getAttribute("aria-labelledby");if(i){let r=i.split(" ").map(a=>{let u=document.getElementById(a);if(u){let t=u.getAttribute("aria-label");return typeof t=="string"?t.trim():_(u).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return _(e).trim()}function Fe(e){let o=c.useRef(""),i=c.useRef("");return p(()=>{let r=e.current;if(!r)return"";let a=r.innerText;if(o.current===a)return i.current;let u=Ee(r).trim().toLowerCase();return o.current=a,i.current=u,u})}var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),ke=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ke||{}),Me=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Me||{}),Ae=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(Ae||{});function G(e,o=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,r=Pe(o(e.options.slice()),u=>u.dataRef.current.domRef.current),a=i?r.indexOf(i):null;return a===-1&&(a=null),{options:r,activeOptionIndex:a}}let Be={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let o=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,r=e.options.findIndex(a=>i(a.dataRef.current.value));return r!==-1&&(o=r),{...e,listboxState:0,activeOptionIndex:o}},2(e,o){var i;if(e.dataRef.current.disabled||e.listboxState===1)return e;let r=G(e),a=xe(o,{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...e,...r,searchQuery:"",activeOptionIndex:a,activationTrigger:(i=o.trigger)!=null?i:1}},3:(e,o)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,r=e.searchQuery+o.value.toLowerCase(),a=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(t=>{var l;return!t.dataRef.current.disabled&&((l=t.dataRef.current.textValue)==null?void 0:l.startsWith(r))}),u=a?e.options.indexOf(a):-1;return u===-1||u===e.activeOptionIndex?{...e,searchQuery:r}:{...e,searchQuery:r,activeOptionIndex:u,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,o)=>{let i={id:o.id,dataRef:o.dataRef},r=G(e,a=>[...a,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(o.dataRef.current.value)&&(r.activeOptionIndex=r.options.indexOf(i)),{...e,...r}},6:(e,o)=>{let i=G(e,r=>{let a=r.findIndex(u=>u.id===o.id);return a!==-1&&r.splice(a,1),r});return{...e,...i,activationTrigger:1}},7:(e,o)=>({...e,labelId:o.id})},W=c.createContext(null);W.displayName="ListboxActionsContext";function w(e){let o=c.useContext(W);if(o===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,w),i}return o}let J=c.createContext(null);J.displayName="ListboxDataContext";function k(e){let o=c.useContext(J);if(o===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,k),i}return o}function Qe(e,o){return P(o.type,Be,e,o)}let Ue=c.Fragment;function Ne(e,o){let{value:i,defaultValue:r,form:a,name:u,onChange:t,by:l=(s,d)=>s===d,disabled:b=!1,horizontal:g=!1,multiple:O=!1,...I}=e;const D=g?"horizontal":"vertical";let T=E(o),[R=O?[]:void 0,L]=me(i,t,r),[v,n]=c.useReducer(Qe,{dataRef:c.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),x=c.useRef({static:!1,hold:!1}),M=c.useRef(null),A=c.useRef(null),j=c.useRef(null),S=p(typeof l=="string"?(s,d)=>{let h=l;return(s==null?void 0:s[h])===(d==null?void 0:d[h])}:l),$=c.useCallback(s=>P(f.mode,{1:()=>R.some(d=>S(d,s)),0:()=>S(R,s)}),[R]),f=c.useMemo(()=>({...v,value:R,disabled:b,mode:O?1:0,orientation:D,compare:S,isSelected:$,optionsPropsRef:x,labelRef:M,buttonRef:A,optionsRef:j}),[R,b,O,v]);z(()=>{v.dataRef.current=f},[f]),be([f.buttonRef,f.optionsRef],(s,d)=>{var h;n({type:1}),$e(d,De.Loose)||(s.preventDefault(),(h=f.buttonRef.current)==null||h.focus())},f.listboxState===0);let te=c.useMemo(()=>({open:f.listboxState===0,disabled:b,value:R}),[f,b,R]),re=p(s=>{let d=f.options.find(h=>h.id===s);d&&q(d.dataRef.current.value)}),ne=p(()=>{if(f.activeOptionIndex!==null){let{dataRef:s,id:d}=f.options[f.activeOptionIndex];q(s.current.value),n({type:2,focus:y.Specific,id:d})}}),oe=p(()=>n({type:0})),ie=p(()=>n({type:1})),ae=p((s,d,h)=>s===y.Specific?n({type:2,focus:y.Specific,id:d,trigger:h}):n({type:2,focus:s,trigger:h})),le=p((s,d)=>(n({type:5,id:s,dataRef:d}),()=>n({type:6,id:s}))),ue=p(s=>(n({type:7,id:s}),()=>n({type:7,id:null}))),q=p(s=>P(f.mode,{0(){return L==null?void 0:L(s)},1(){let d=f.value.slice(),h=d.findIndex(Q=>S(Q,s));return h===-1?d.push(s):d.splice(h,1),L==null?void 0:L(d)}})),se=p(s=>n({type:3,value:s})),ce=p(()=>n({type:4})),de=c.useMemo(()=>({onChange:q,registerOption:le,registerLabel:ue,goToOption:ae,closeListbox:ie,openListbox:oe,selectActiveOption:ne,selectOption:re,search:se,clearSearch:ce}),[]),pe={ref:T},B=c.useRef(null),fe=N();return c.useEffect(()=>{B.current&&r!==void 0&&fe.addEventListener(B.current,"reset",()=>{L==null||L(r)})},[B,L]),U.createElement(W.Provider,{value:de},U.createElement(J.Provider,{value:f},U.createElement(ye,{value:P(f.listboxState,{0:H.Open,1:H.Closed})},u!=null&&R!=null&&ge({[u]:R}).map(([s,d],h)=>U.createElement(he,{features:Le.Hidden,ref:h===0?Q=>{var X;B.current=(X=Q==null?void 0:Q.closest("form"))!=null?X:null}:void 0,...Oe({key:s,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:a,disabled:b,name:s,value:d})})),F({ourProps:pe,theirProps:I,slot:te,defaultTag:Ue,name:"Listbox"}))))}let ze="button";function He(e,o){var i;let r=V(),{id:a=`headlessui-listbox-button-${r}`,...u}=e,t=k("Listbox.Button"),l=w("Listbox.Button"),b=E(t.buttonRef,o),g=N(),O=p(v=>{switch(v.key){case m.Space:case m.Enter:case m.ArrowDown:v.preventDefault(),l.openListbox(),g.nextFrame(()=>{t.value||l.goToOption(y.First)});break;case m.ArrowUp:v.preventDefault(),l.openListbox(),g.nextFrame(()=>{t.value||l.goToOption(y.Last)});break}}),I=p(v=>{switch(v.key){case m.Space:v.preventDefault();break}}),D=p(v=>{if(Te(v.currentTarget))return v.preventDefault();t.listboxState===0?(l.closeListbox(),g.nextFrame(()=>{var n;return(n=t.buttonRef.current)==null?void 0:n.focus({preventScroll:!0})})):(v.preventDefault(),l.openListbox())}),T=ee(()=>{if(t.labelId)return[t.labelId,a].join(" ")},[t.labelId,a]),R=c.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),L={ref:b,id:a,type:Re(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(i=t.optionsRef.current)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":T,disabled:t.disabled,onKeyDown:O,onKeyUp:I,onClick:D};return F({ourProps:L,theirProps:u,slot:R,defaultTag:ze,name:"Listbox.Button"})}let Ve="label";function je(e,o){let i=V(),{id:r=`headlessui-listbox-label-${i}`,...a}=e,u=k("Listbox.Label"),t=w("Listbox.Label"),l=E(u.labelRef,o);z(()=>t.registerLabel(r),[r]);let b=p(()=>{var O;return(O=u.buttonRef.current)==null?void 0:O.focus({preventScroll:!0})}),g=c.useMemo(()=>({open:u.listboxState===0,disabled:u.disabled}),[u]);return F({ourProps:{ref:l,id:r,onClick:b},theirProps:a,slot:g,defaultTag:Ve,name:"Listbox.Label"})}let qe="ul",Ge=Y.RenderStrategy|Y.Static;function Ke(e,o){var i;let r=V(),{id:a=`headlessui-listbox-options-${r}`,...u}=e,t=k("Listbox.Options"),l=w("Listbox.Options"),b=E(t.optionsRef,o),g=N(),O=N(),I=Ie(),D=(()=>I!==null?(I&H.Open)===H.Open:t.listboxState===0)();c.useEffect(()=>{var n;let x=t.optionsRef.current;x&&t.listboxState===0&&x!==((n=Ce(x))==null?void 0:n.activeElement)&&x.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let T=p(n=>{switch(O.dispose(),n.key){case m.Space:if(t.searchQuery!=="")return n.preventDefault(),n.stopPropagation(),l.search(n.key);case m.Enter:if(n.preventDefault(),n.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:x}=t.options[t.activeOptionIndex];l.onChange(x.current.value)}t.mode===0&&(l.closeListbox(),K().nextFrame(()=>{var x;return(x=t.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})}));break;case P(t.orientation,{vertical:m.ArrowDown,horizontal:m.ArrowRight}):return n.preventDefault(),n.stopPropagation(),l.goToOption(y.Next);case P(t.orientation,{vertical:m.ArrowUp,horizontal:m.ArrowLeft}):return n.preventDefault(),n.stopPropagation(),l.goToOption(y.Previous);case m.Home:case m.PageUp:return n.preventDefault(),n.stopPropagation(),l.goToOption(y.First);case m.End:case m.PageDown:return n.preventDefault(),n.stopPropagation(),l.goToOption(y.Last);case m.Escape:return n.preventDefault(),n.stopPropagation(),l.closeListbox(),g.nextFrame(()=>{var x;return(x=t.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})});case m.Tab:n.preventDefault(),n.stopPropagation();break;default:n.key.length===1&&(l.search(n.key),O.setTimeout(()=>l.clearSearch(),350));break}}),R=ee(()=>{var n;return(n=t.buttonRef.current)==null?void 0:n.id},[t.buttonRef.current]),L=c.useMemo(()=>({open:t.listboxState===0}),[t]),v={"aria-activedescendant":t.activeOptionIndex===null||(i=t.options[t.activeOptionIndex])==null?void 0:i.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":R,"aria-orientation":t.orientation,id:a,onKeyDown:T,role:"listbox",tabIndex:0,ref:b};return F({ourProps:v,theirProps:u,slot:L,defaultTag:qe,features:Ge,visible:D,name:"Listbox.Options"})}let We="li";function Je(e,o){let i=V(),{id:r=`headlessui-listbox-option-${i}`,disabled:a=!1,value:u,...t}=e,l=k("Listbox.Option"),b=w("Listbox.Option"),g=l.activeOptionIndex!==null?l.options[l.activeOptionIndex].id===r:!1,O=l.isSelected(u),I=c.useRef(null),D=Fe(I),T=Se({disabled:a,value:u,domRef:I,get textValue(){return D()}}),R=E(o,I);z(()=>{if(l.listboxState!==0||!g||l.activationTrigger===0)return;let S=K();return S.requestAnimationFrame(()=>{var $,f;(f=($=I.current)==null?void 0:$.scrollIntoView)==null||f.call($,{block:"nearest"})}),S.dispose},[I,g,l.listboxState,l.activationTrigger,l.activeOptionIndex]),z(()=>b.registerOption(r,T),[T,r]);let L=p(S=>{if(a)return S.preventDefault();b.onChange(u),l.mode===0&&(b.closeListbox(),K().nextFrame(()=>{var $;return($=l.buttonRef.current)==null?void 0:$.focus({preventScroll:!0})}))}),v=p(()=>{if(a)return b.goToOption(y.Nothing);b.goToOption(y.Specific,r)}),n=ve(),x=p(S=>n.update(S)),M=p(S=>{n.wasMoved(S)&&(a||g||b.goToOption(y.Specific,r,0))}),A=p(S=>{n.wasMoved(S)&&(a||g&&b.goToOption(y.Nothing))}),j=c.useMemo(()=>({active:g,selected:O,disabled:a}),[g,O,a]);return F({ourProps:{id:r,ref:R,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":O,disabled:void 0,onClick:L,onFocus:v,onPointerEnter:x,onMouseEnter:x,onPointerMove:M,onMouseMove:M,onPointerLeave:A,onMouseLeave:A},theirProps:t,slot:j,defaultTag:We,name:"Listbox.Option"})}let Xe=C(Ne),Ye=C(He),Ze=C(je),_e=C(Ke),et=C(Je),ct=Object.assign(Xe,{Button:Ye,Label:Ze,Options:_e,Option:et});export{ct as I};
